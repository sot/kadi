
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Commands archive v1 &#8212; kadi 7.4.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-astropy.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API documentation" href="api.html" />
    <link rel="prev" title="Commands archive v2 details" href="commands_v2.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="index.html"><span id="logotext1">Ska!</span><span id="logotext2">Kadi</span><span id="logotext3"></span></a>
  <ul>
    
    <li><a class="home" title="Homepage" href="https://sot.github.io/">
        <span id="logotext1">ska</span><span id="logotext2">tools</span>
    </a></li>
    <li><a title="General Index" href="genindex.html">Index</a></li>
    <li><a title="Module Index" href="py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="api.html" title="API documentation">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="commands_v2.html" title="Commands archive v2 details">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="index.html">kadi 7.4.0 documentation</a>
	 &#187;
      </li>
      <li><a href="commands_states.html" accesskey="U">Commands and states</a> &#187;</li>
      
      <li>Commands archive v1</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="commands-archive-v1">
<h1>Commands archive v1<a class="headerlink" href="#commands-archive-v1" title="Permalink to this headline">¶</a></h1>
<p>In order to use the v1 version do the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">kadi</span> <span class="kn">import</span> <span class="n">commands</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">commands_version</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>  <span class="c1"># must be the string &quot;1&quot; not int 1</span>
</pre></div>
</div>
<p>An alternative is to set the <code class="docutils literal notranslate"><span class="pre">KADI_COMMANDS_VERSION</span></code> environment variable to
<code class="docutils literal notranslate"><span class="pre">1</span></code>. This will globally apply to all subsequent Python sessions that inherit
this environment. For example from a linux/Mac bash command shell you can
enter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ export KADI_COMMANDS_VERSION=1
</pre></div>
</div>
<p>The basic way to select commands is with the <a class="reference internal" href="api.html#kadi.commands.commands.get_cmds" title="kadi.commands.commands.get_cmds"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_cmds()</span></code></a> method.  For example you can find
load commands from early in 2013 with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">kadi</span> <span class="kn">import</span> <span class="n">commands</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmds</span> <span class="o">=</span> <span class="n">commands</span><span class="o">.</span><span class="n">get_cmds</span><span class="p">(</span><span class="s1">&#39;2013:001:00:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2013:001:00:56:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cmds</span><span class="p">)</span>
<span class="go">        date            type      tlmsid   scs step      time     timeline_id   vcdu  params</span>
<span class="go">--------------------- ---------- ---------- --- ---- ------------- ----------- ------- ------</span>
<span class="go">2013:001:00:37:37.653   ORBPOINT       None   0    0 473387924.837   426098988 5533112    N/A</span>
<span class="go">2013:001:00:53:07.181 COMMAND_SW   AOACRSTD 129 1524 473388854.365   426098990 5584176    N/A</span>
<span class="go">2013:001:00:54:07.181 COMMAND_SW   AOFUNCDS 129 1526 473388914.365   426098990 5584410    N/A</span>
<span class="go">2013:001:00:55:07.181 COMMAND_SW   AOFUNCDS 129 1528 473388974.365   426098990 5584644    N/A</span>
<span class="go">2013:001:00:56:07.181 COMMAND_SW   AONMMODE 129 1530 473389034.365   426098990 5584878    N/A</span>
<span class="go">2013:001:00:56:07.181    ACISPKT AA00000000 132 1620 473389034.365   426098991 5584878    N/A</span>
<span class="go">2013:001:00:56:07.181   SIMTRANS       None 132 1623 473389034.365   426098991 5584878    N/A</span>
<span class="go">2013:001:00:56:07.438 COMMAND_SW   AONM2NPE 129 1532 473389034.622   426098990 5584879    N/A</span>
</pre></div>
</div>
<p>In the <a class="reference internal" href="api.html#kadi.commands.commands.get_cmds" title="kadi.commands.commands.get_cmds"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_cmds()</span></code></a> method, commands are selected with <code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">&lt;=</span> <span class="pre">date</span> <span class="pre">&lt;</span> <span class="pre">stop</span></code>, where each
of these are evaluated as a date string with millisec precision.  In order to get commands
at exactly a certain date you need to select with the <code class="docutils literal notranslate"><span class="pre">date</span></code> argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">get_cmds</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="s1">&#39;2013:001:00:56:07.181&#39;</span><span class="p">))</span>
<span class="go">         date            type      tlmsid   scs step timeline_id params</span>
<span class="go">--------------------- ---------- ---------- --- ---- ----------- ------</span>
<span class="go">2013:001:00:56:07.181 COMMAND_SW   AONMMODE 129 1530   426098990    N/A</span>
<span class="go">2013:001:00:56:07.181    ACISPKT AA00000000 132 1620   426098991    N/A</span>
<span class="go">2013:001:00:56:07.181   SIMTRANS       None 132 1623   426098991    N/A</span>
</pre></div>
</div>
<p>The output <code class="docutils literal notranslate"><span class="pre">cmds</span></code> is based on the astropy <a class="reference external" href="http://docs.astropy.org/en/stable/table/index.html">Table</a> object with many powerful and handy
features built in.  For instance you could sort by <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">tlmsid</span></code> and <code class="docutils literal notranslate"><span class="pre">date</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cmds_type</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmds_type</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;tlmsid&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cmds_type</span><span class="p">)</span>
<span class="go">         date            type      tlmsid   scs step timeline_id params</span>
<span class="go">--------------------- ---------- ---------- --- ---- ----------- ------</span>
<span class="go">2013:001:00:56:07.181    ACISPKT AA00000000 132 1620   426098991    N/A</span>
<span class="go">2013:001:00:53:07.181 COMMAND_SW   AOACRSTD 129 1524   426098990    N/A</span>
<span class="go">2013:001:00:54:07.181 COMMAND_SW   AOFUNCDS 129 1526   426098990    N/A</span>
<span class="go">2013:001:00:55:07.181 COMMAND_SW   AOFUNCDS 129 1528   426098990    N/A</span>
<span class="go">2013:001:00:56:07.438 COMMAND_SW   AONM2NPE 129 1532   426098990    N/A</span>
<span class="go">2013:001:00:56:07.181 COMMAND_SW   AONMMODE 129 1530   426098990    N/A</span>
<span class="go">2013:001:00:37:37.653   ORBPOINT       None   0    0   426098988    N/A</span>
<span class="go">2013:001:00:56:07.181   SIMTRANS       None 132 1623   426098991    N/A</span>
</pre></div>
</div>
<p>You can print a single command and get all the information about it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cmds</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="go">2013:001:00:56:07.181 ACISPKT tlmsid=AA00000000 scs=132 step=1620 timeline_id=426098991 cmds=3 packet(40)=D80000300030603001300 words=3</span>
</pre></div>
</div>
<p>This command has a number of attributes like <code class="docutils literal notranslate"><span class="pre">date</span></code> or <code class="docutils literal notranslate"><span class="pre">tlmsid</span></code> (shown in the original table) as well as command <em>parameters</em>: <code class="docutils literal notranslate"><span class="pre">cmds</span></code>, <code class="docutils literal notranslate"><span class="pre">packet(40)</span></code>, and <code class="docutils literal notranslate"><span class="pre">words</span></code>.  You can access any of the attributes or parameters like a dictionary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cmds</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="s1">&#39;packet(40)&#39;</span><span class="p">])</span>
<span class="go">D80000300030603001300</span>
</pre></div>
</div>
<p>You probably noticed the first time we printed <code class="docutils literal notranslate"><span class="pre">cmds</span></code> that the command parameters
<code class="docutils literal notranslate"><span class="pre">params</span></code> were all listed as <code class="docutils literal notranslate"><span class="pre">N/A</span></code> (Not Available).  What happens if we print the
table again:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cmds</span><span class="p">)</span>
<span class="go">         date            type      tlmsid   scs step timeline_id                      params</span>
<span class="go">--------------------- ---------- ---------- --- ---- ----------- -----------------------------------------------</span>
<span class="go">2013:001:00:37:37.653   ORBPOINT       None   0    0   426098988                                             N/A</span>
<span class="go">2013:001:00:53:07.181 COMMAND_SW   AOACRSTD 129 1524   426098990                                             N/A</span>
<span class="go">2013:001:00:54:07.181 COMMAND_SW   AOFUNCDS 129 1526   426098990                                             N/A</span>
<span class="go">2013:001:00:55:07.181 COMMAND_SW   AOFUNCDS 129 1528   426098990                                             N/A</span>
<span class="go">2013:001:00:56:07.181 COMMAND_SW   AONMMODE 129 1530   426098990                                             N/A</span>
<span class="go">2013:001:00:56:07.181    ACISPKT AA00000000 132 1620   426098991 cmds=3 packet(40)=D80000300030603001300 words=3</span>
<span class="go">2013:001:00:56:07.181   SIMTRANS       None 132 1623   426098991                                             N/A</span>
<span class="go">2013:001:00:56:07.438 COMMAND_SW   AONM2NPE 129 1532   426098990                                             N/A</span>
</pre></div>
</div>
<p>So what happened?  The answer is that for performance reasons the <code class="xref py py-class docutils literal notranslate"><span class="pre">CommandTable</span></code> class is
lazy about loading the command parameters, and only does so when you directly request the
parameter value (as we did with <code class="docutils literal notranslate"><span class="pre">packet(40)</span></code>).  If you want to just fetch them all
at once you can do so with the <code class="docutils literal notranslate"><span class="pre">fetch_params()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cmds</span><span class="o">.</span><span class="n">fetch_params</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cmds</span><span class="p">)</span>
<span class="go">         date            type      tlmsid   scs step timeline_id                      params</span>
<span class="go">--------------------- ---------- ---------- --- ---- ----------- -----------------------------------------------</span>
<span class="go">2013:001:00:37:37.653   ORBPOINT       None   0    0   426098988                              event_type=EQF013M</span>
<span class="go">2013:001:00:53:07.181 COMMAND_SW   AOACRSTD 129 1524   426098990                       hex=8032000 msid=AOACRSTD</span>
<span class="go">2013:001:00:54:07.181 COMMAND_SW   AOFUNCDS 129 1526   426098990           aopcadsd=21 hex=8030215 msid=AOFUNCDS</span>
<span class="go">2013:001:00:55:07.181 COMMAND_SW   AOFUNCDS 129 1528   426098990           aopcadsd=32 hex=8030220 msid=AOFUNCDS</span>
<span class="go">2013:001:00:56:07.181 COMMAND_SW   AONMMODE 129 1530   426098990                       hex=8030402 msid=AONMMODE</span>
<span class="go">2013:001:00:56:07.181    ACISPKT AA00000000 132 1620   426098991 cmds=3 packet(40)=D80000300030603001300 words=3</span>
<span class="go">2013:001:00:56:07.181   SIMTRANS       None 132 1623   426098991                                      pos=-99616</span>
<span class="go">2013:001:00:56:07.438 COMMAND_SW   AONM2NPE 129 1532   426098990                       hex=8030601 msid=AONM2NPE</span>
</pre></div>
</div>
<p>Finally, note that you can request the value of an attribute or parameter for the entire
command table.  Note that command rows without that parameter will have a <code class="docutils literal notranslate"><span class="pre">None</span></code> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cmds</span><span class="p">[</span><span class="s1">&#39;msid&#39;</span><span class="p">])</span>
<span class="go">  msid</span>
<span class="go">--------</span>
<span class="go">    None</span>
<span class="go">AOACRSTD</span>
<span class="go">AOFUNCDS</span>
<span class="go">AOFUNCDS</span>
<span class="go">AONMMODE</span>
<span class="go">    None</span>
<span class="go">    None</span>
<span class="go">AONM2NPE</span>
</pre></div>
</div>
<section id="notes-and-caveats">
<h2>Notes and caveats<a class="headerlink" href="#notes-and-caveats" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The exact set of load commands relies on the <a class="reference external" href="http://cxc.harvard.edu/mta/ASPECT/tool_doc/cmd_states">Chandra commanded states database</a> to determine which command
loads ran on-board and for what duration.  This information comes from a combination of
the iFOT load segments database and SOT update procedures for load interrupts.  It has
been used operationally since 2009 and has frequent validation checking in the course of
thermal load review.  Nevertheless there are likely a few missing commands here and
there, particularly associated with load stoppages and replans.</p></li>
<li><p>The kadi commands archive includes all commands for approved loads.  Once loads have
been ingested into the database and iFOT has been updated accordingly, then the kadi
commands will reflect this update (within an hour).</p></li>
<li><p>Conversely if there is a load interrupt (SCS-107 or anomaly) then this will be reflected
in the commands archive within an hour after an on-call person runs a script to update
the <a class="reference external" href="http://cxc.harvard.edu/mta/ASPECT/tool_doc/cmd_states">Chandra commanded states database</a>.</p></li>
<li><p>Each load command has an identifier that can be used to retrieve the exact set of mission
planning products in which the command was generated.  This is valid even in the case
of a re-open replan in which a command load effectively has two source directories.</p></li>
<li><p>The archive includes a select set of non-load commands which result from either
autonomous on-board commanding (e.g. SCS-107) or real-time ground commanding
(e.g. anomaly recovery).  This list is not comprehensive but includes those
commands which typically affect mission planning continuity and thermal modeling.</p></li>
<li><p>The parameters for the ACA star catalog command <code class="docutils literal notranslate"><span class="pre">AOSTRCAT</span></code> are not included since this
alone would dramatically increase the database file size.  However, the commands are
included.</p></li>
<li><p>The command archive is stored in a highly performant HDF5 file backed by a
dictionary-based index file of unique command parameters.  As of 2018-Jan, the commands
archive is stored in two files with a total size about 52 Mb.</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/ska.png" alt="Logo"/>
            </a></p><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Commands archive v1</a><ul>
<li><a class="reference internal" href="#notes-and-caveats">Notes and caveats</a></li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="commands_v2.html"
                        title="previous chapter">Commands archive v2 details</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="api.html"
                        title="next chapter">API documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/commands_v1.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="_sources/commands_v1.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2013, Tom Aldcroft.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 4.2.0. &nbsp;
  </p>
</footer>
  </body>
</html>